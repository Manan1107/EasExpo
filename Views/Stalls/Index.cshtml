@model IEnumerable<StallListItemViewModel>
@using System
@{
    ViewData["Title"] = "Browse stalls";
    var search = ViewData["Search"] as string;
    var selectedStatus = ViewData["SelectedStatus"] as string ?? "All";
}

<div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between mb-3">
    <h1 class="h3 mb-3 mb-md-0">Browse stalls</h1>
    <form method="get" class="form-inline">
        <div class="form-group mb-2 mr-sm-2">
            <input type="text" class="form-control" name="search" placeholder="Search" value="@search" />
        </div>
        <div class="form-group mb-2 mr-sm-2">
            <select class="form-control" name="status">
                @{ var statuses = new[] { "All", "Available", "Booked", "Maintenance" }; }
                @foreach (var statusOption in statuses)
                {
                    if (string.Equals(statusOption, selectedStatus, System.StringComparison.OrdinalIgnoreCase))
                    {
                        <option value="@statusOption" selected>@statusOption</option>
                    }
                    else
                    {
                        <option value="@statusOption">@statusOption</option>
                    }
                }
            </select>
        </div>
        <button type="submit" class="btn btn-outline-primary mb-2">Filter</button>
    </form>
</div>

@if (!Model.Any())
{
    <div class="alert alert-info">No stalls match your filters. Try broadening your search.</div>
}
else
{
    <div class="row">
    @foreach (var stall in Model)
    {
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm border-0">
                <div class="card-body">
                    <h5 class="card-title">@stall.Name</h5>
                    <p class="card-text text-muted mb-1">@stall.Location</p>
                    <p class="card-text mb-2">Rent: <strong>â‚¹@stall.RentPerDay.ToString("N0")</strong> / day</p>
                    <span class="badge badge-pill @(stall.Status == StallStatus.Available ? "badge-success" : stall.Status == StallStatus.Booked ? "badge-warning" : "badge-secondary")">
                        @stall.Status
                    </span>
                </div>
                <div class="card-footer bg-white border-0">
                    <a asp-action="Details" asp-route-id="@stall.Id" class="btn btn-outline-primary btn-block">View details</a>
                </div>
            </div>
        </div>
    }
    </div>
}
